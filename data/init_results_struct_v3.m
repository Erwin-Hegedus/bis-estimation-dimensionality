function results = init_results_struct_v3(nP)
    results = struct();
    results.patient_id = NaN(nP, 1);
    
    % Demographics for Table 1
    results.demographics = repmat(struct('Age', NaN, 'Weight', NaN, 'Height', NaN, ...
        'Sex', '', 'Duration', NaN), nP, 1);
    
    results.raw = repmat(struct('time', [], 'bis', [], ...
        'pred_van', [], 'pred_gre', [], 'pred_pop', [], ...
        'pred_kscale', [], ...
        'pred_loglin', [], ...
        'pred_2d', [], ... 
        'pred_2d_fim', [], ... 
        'Xhist_van', [], 'Xhist_gre', [], ...
        'Xhist_loglin', [], ...
        'Phist_van', [], ...
        'FIM_cond_hist', [], ...
        'RSE_van', [], 'RSE_gre', [], ...
        'CeP_trajectory', [], 'CeR_trajectory', [], ...
        'ke0_trajectory', [], 'tau_d_trajectory', [], ...
        'BISmin_trajectory', [], ...
        'E0_trajectory', [], ...
        'k_trajectory', [], ...
        'kP_trajectory', [], ... 
        'kR_trajectory', [], ... 
        'kP_fim_trajectory', [], ... 
        'kR_fim_trajectory', [], ... 
        'k_hist', [], 'k_var', [], ...
        'kP_hist', [], 'kR_hist', [], ... 
        'kP_var', [], 'kR_var', [], ...
        'induction_start_sample', NaN, 'induction_end_sample', NaN), nP, 1);
    
    results.metrics.van = struct('MAE', nan(nP, 1));
    results.metrics.gre = struct('MAE', nan(nP, 1));
    results.metrics.pop = struct('MAE', nan(nP, 1));
    results.metrics.kscale = struct('MAE', nan(nP, 1));
    results.metrics.loglin = struct('MAE', nan(nP, 1));
    results.metrics.m2d = struct('MAE', nan(nP, 1)); 
    results.metrics.m2d_fim = struct('MAE', nan(nP, 1));
    
    results.fail_ids = [];
end
